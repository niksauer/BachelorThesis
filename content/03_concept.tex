%!TEX root = ../main.tex

\chapter{Concept}
\label{chp:concept}

\section{Incentivized Deposit-Refund System}
\label{sec:incentivizedSystem}

\subsection{Overview}
\label{sec:incentivizedOverview}
An incentivized deposit-refund system, as is outlined in the following, aims to:

\begin{enumerate}[label=(\Alph*)]
  \item \label{bolsterQuote} bolster the quote of beverages sold in reusable packaging
  \item \label{preventPollution} prevent pollution of the environment caused from throwing away bottles
  \item support the cause of environmental agencies
\end{enumerate}

From a game theoretical perspective, \ref{bolsterQuote} and \ref{preventPollution} are presumably achieved by \footnote{Lending itself to the fact that solely threatening retailers and bottlers with the introduction of a deposit-refund system had not been a successful approach (comp.~\autoref{ftn:presumedEffects} and \autoref{fig:reusableQuoteDevelopment} on pp.~\rangeref{presumedHappenedEffects}).}:

\begin{itemize}
  \item rewarding consumers who purchase reusable bottles
  \item punishing consumers whose bottles are eventually thrown away
\end{itemize}

To translate these measures into reality, it will be necessary to alter the current deposit-refund system (see~\ref{sec:depositRefundCycle}) so that:

\begin{itemize}
  \item non-claimed deposits are redistributed among agencies and reusable bottle consumers
  \item a penalty is added onto future deposits of consumers who repeatedly pollute
\end{itemize}

Practically, this will require garbage collection to report how many and which specific one-way bottles have been thrown away. Otherwise, it will not be possible to calculate the amount of non-claimed deposits and identify which consumer was responsible for the bottle at last. The latter infers that bottles must be uniquely identifiable. On the other hand, such a system can only be realized if retailers forward the information that a consumer has bought reusable bottles and has thereby become eligible to receive rewards. Furthermore, to establish proper ownership, they must also report which one-way bottles a consumer has purchased. Lastly, it should be prevented that anybody can report these figures, pretend to be an environmental agency or claim someone else's rewards. This core functionality, together with the existing minimum level of service, can be expressed in terms of the different interactions a certain user may have with the system, known as a use case diagram and given by \autoref{fig:useCaseOverview}.

\begin{figure}[hbt]
  \includegraphics[width=\textwidth]{images/concept/use_case_overview}
  \caption{Use case overview}
  \label{fig:useCaseOverview}
\end{figure}

\FloatBarrier

From this overview, it becomes apparent that a revised approach will essentially incorporate an accounting layer to enable the punishment and rewarding of consumers. Basic protocols of interaction (i.e.~buying and returning a bottle) should only be modified to the minimum extent needed.

\subsection{Proposed Rules}
\label{sec:rules}
Having given a high-level introduction to an incentivized deposit-refund system, this section aims to provide an exemplary set of rules that may constitute the underlying business logic. Again, it must be noted that this only serves as a guideline for architecting such a solution. The precise economics, psychological effectiveness and ethics introduced hereby are disregarded (comp.~\ref{sec:goalsScope}).

\subsubsection{Rewards \& Donations}

\begin{itemize}
 	\item 50\% of non-claimed deposits are reserved for donations (\textit{agency fund})
  	\item 50\% of non-claimed deposits are reserved for rewards (\textit{consumer fund})
  	\item rewards and donations can be claimed once in each period
  	\item a period's duration is set at 4 weeks
  	\item a consumer's reward ($r_c$) is based on the amount of reusable bottles ($b$) he has purchased within the previous period, thus can be calculated as:

\begin{equation}
r_c = \frac{b}{b_{total}} \times f_c
\label{eq:rewardCalculation}
\end{equation}

where $b_{total}$ denotes the total number of reusable bottles sold within that period and $f_c$ resembles the consumer fund

	\item non-claimed rewards are withheld % for self-financing
  	\item the agency fund ($f_a$) is evenly distributed, so that each's donation ($d$) will be $d = f_a/n$, where $n$ refers to the number of approved agencies
  	\item non-claimed donations remain available for all agencies in the next period
\end{itemize}

\subsubsection{Penalties}

\begin{itemize}
 	\item if a consumer repeatedly pollutes, he must pay a penalty on top of each deposit
	\item the threshold ($t$) to receive a penalty is set at 5 thrown away bottles
  	\item the penalty's value ($v$) is set at \EUR{0.05}
  	\item a consumer's penalty ($p_c$) is proportional to the number of bottles ($b$) he has thrown away during the lifetime of this system, meaning that: 

\begin{equation}
p_c = \frac{b - (b \mod t)}{t} \times v
\label{eq:penaltyCalculcation}
\end{equation}

  	\item the penalty is refunded, if the consumer returns the bottle on his own
  	\item the penalty is seized, if the bottle is thrown away or returned by someone else
%  	\item seized penalties are also used for self-financing
\end{itemize}

% functional requirements formatter
\def\twodigits#1{%
%  \ifnum#1<100 0\fi
  \ifnum#1<10 0\fi
  \number#1}

\newlist{FR}{enumerate}{1}
\setlist[FR]{label=FR-\arabic*:}

% start of functional requirements
\subsection{Functional Requirements}
In accordance to \ref{sec:incentivizedOverview} and \ref{sec:rules}, the following functional requirements are defined as the bare minimum of features any implementation must provide in order to be used as the accounting backend of an incentivized deposit-refund system. These requirements are expressed from the perspective of an end-user who hopes to achieve different goals by using the system and are grouped by the various roles encountered (comp.~\autoref{fig:useCaseOverview}).

Of course, consumers and environmental agencies will also expect a method to claim the promised rewards and donations respectively, so that two additional requirements are formulated subsequently.

\paragraph{Garbage collector}
\begin{enumerate}[label={\textbf{FR-\protect\twodigits{\theenumi}}},leftmargin=*]
	\item As a garbage collector, I can report the number of thrown away bottles, so that the amount of non-claimed deposits can be calculated. \label{itm:reportNumber}
	\item As a garbage collector, I can report the identifier of a thrown away bottle, so that the responsible consumer can be punished. \label{itm:reportIdentifier}
\end{enumerate}

\paragraph{Retailer}
\begin{enumerate}[resume, label={\textbf{FR-\protect\twodigits{\theenumi}}},leftmargin=*]
	\item As a retailer, I can report that a consumer has purchased reusable bottles, so that he becomes eligible to receive rewards.
	\item As a retailer, I can report how many reusable bottles a consumer has bought, so that his share of rewards can be calculated. \label{itm:reportReusables}
	\item As a retailer, I can report which one-way bottles a consumer has bought, so that the ownership of each bottle is recorded. \label{itm:reportOneWays}
	\item As a retailer, I can look up the penalty that a specific consumer must pay, so that this amount can be added onto the deposit of each bottle during purchase. \label{itm:lookUpPenalty}
\end{enumerate}

\paragraph{Take-back point}
\begin{enumerate}[resume, label={\textbf{FR-\protect\twodigits{\theenumi}}},leftmargin=*]
%	\item As a tack-back point, I can put in a claim to be reimbursed for making advance refunds, so that I do not experience a loss by offering this service.
	\item As a tack-back point, I can report which one-way bottles a consumer has returned, so that the penalty, if raised, can be refunded or seized accordingly. \label{itm:reportOneWayReturn}
\end{enumerate}

\paragraph{Consumer}
\begin{enumerate}[resume, label={\textbf{FR-\protect\twodigits{\theenumi}}},leftmargin=*]  
	\item As a consumer, I can claim a reward for having purchased reusable bottles, so that I will be motivated to so in the future even though one-way packaging is lighter (and more durable) when compared to most reusable bottles. 
\end{enumerate}

\paragraph{Environmental agency}
\begin{enumerate}[resume, label={\textbf{FR-\protect\twodigits{\theenumi}}},leftmargin=*]  
	\item As an environmental agency, I can claim a donation, so that my cause will be better supported through the funding secured.
\end{enumerate}
	
\subsection{Preconditions}
\label{sec:preconditions}
While an incentivized deposit-refund system may be effective, it does assume a variety of conditions that must be in place for it to function properly. As previously hinted, they can be described as the:

\begin{description}
	\item[Obligation to report thrown away one-way bottles]
	\hfill \\
	In addition to reporting the total number of thrown away bottles\hide{(\ref{itm:reportNumber})}, garbage collection must also be obliged to communicate the individual identifiers\hide{(\ref{itm:reportIdentifier})}. This assumes that one-way bottles are marked with a label that is unique across all bottles in circulation. Finally, and to automate the whole process, special object recognition machinery will be required along the sorting belt of any given refuse disposal site.
	\item[Obligation to report bottle purchase]
	\hfill \\
	Retailers and initial distributors alike must report which particular one-way bottles a consumer has purchased\hide{(\ref{itm:reportOneWays})}. The same (i.e. quantity) goes for buying reusable bottles \hide{(\ref{itm:reportReusables})} although this only happens through opt-in as people should not be forced to accept rewards. In both cases, it will be necessary to have consumers present a unique means of identification as they complete the purchase.
	\item[Obligation to levy penalty]
	\hfill \\
	Assuming that the consumer qualifies for a penalty, retailers must be impelled to impose this amount upon purchase which itself requires an extension to cash registers so that the amount can be queried dynamically\hide{(\ref{itm:lookUpPenalty})}, given that the consumer has been identified priorly.
	\item[Obligation to report one-way bottle return]
	\hfill \\
	Similar to reporting a purchase, tack-back points have to report which consumer had been responsible for returning a particular one-way bottle\hide{(\ref{itm:reportOneWayReturn})}. Since the return process can either be automated or executed manually (comp.~\autoref{fig:clearingProcess}), different mechanisms to identify the consumer will be needed.  
\end{description}

These prevailing conditions could be enforced by amending the system's legal basis (see~\ref{sec:legalBasis}) and then integrating the relevant clauses into the contracts that \ac{DPG} maintains with each participant (see~\ref{sec:DPGAdministration}). However, the exact realization including that of the measures needed as explained above is out of scope (comp.~\ref{sec:goalsScope}) and thus, assumed to be satisfied for the remainder of this paper. 

\subsection{Non-Functional Requirements}
Whereas functional quality stresses conformance with the design specifications, structural quality addresses non-functional requirements like security and maintainability \cite[p.~2]{Martinez-Ortiz:2016:QMW:3011141.3011203}. Together, both can be used to constitute the evaluation framework for measuring a system's quality, better known as \ac{QoS}. \citeauthor{Liu:2004:QCP:1013367.1013379} argue that it is not practical to come up with a standard model of attributes because \ac{QoS} is a broad, context-dependent concept \cite[p.~67]{Liu:2004:QCP:1013367.1013379}. Therefore, the following list of desired structural properties is based on those already encompassed in the current deposit-refund system or those which are absolutely necessary to implement an incentivized version. All other traits will be left open for discussion in the end.

\begin{description}
	\item[Access Security]
	\hfill \\
	The system shall distinguish between authorized and non-authorized users. More specifically, the individual features outlined above shall only be accessible to their designated user\hide{(\textbf{NFR-01}\label{itm:accessSecurity})}.
	\item[Availability]
	\hfill \\
	The system shall be available for use between the hours of 6:00 am and 24:00 pm \hide{(\textbf{NFR-02}\label{itm:operatingTimes})} which is justified by the fact that most sales and returns will happen within this timeframe. Exceptions must therefore be maintained in a local backlog of unsent reports and transmitted at the next possible point in time. The same is true for claiming rewards and donations.
	\item[Cost]
	\hfill \\
	The system shall be no more costly in operation than it currently is\hide{(\textbf{NFR-03}\label{itm:operatingCost})}. Total membership and bottle registration fees may be taken as a baseline (see~\ref{sec:DPGRoles}).
	\item[Reliability, Scalability \& Efficiency]
	\hfill \\
	The system shall be able to handle all user requests and by such shall be scalable to support unlimited growth in the number of actors\hide{(\textbf{NFR-04}\label{itm:unlimitedGrowth})}. Further, any request must be executed by the end of the day \hide{(\textbf{NFR-05}\label{itm:responseTime})} to ensure the timely application of penalties, as well as to have a proper statement ready by the end of the month.
	\item[Integrity]
	\hfill \\
	All monetary amounts (i.e.~rewards and donations) must be calculated accurately before being rounded down to two decimal places\hide{(\textbf{NFR-06}\label{itm:calculcations})}. The latter ensures that no more funds are distributed than are available. Additionally, only integer figures may be reported and must be recorded as is\hide{(\textbf{NFR-07}\label{itm:onlyInteger})}.
\end{description}
	
\pagebreak

\section{Architecture}
\subsection{Smart-Contract as a Clearing House}
The biggest roadblock to implementing an incentivized deposit-refund system (see~\ref{sec:incentivizedSystem}) is given by the fact that \ac{DPG} has decided against using a central clearing mechanism to settle refund claims of tack-back points (comp.~\nameref{sec:DPGAdministration} on \autopageref{sec:DPGAdministration}). Instead, refund claimants must invoice each of the initial distributors for which a bottle was taken back and present data proving the number of accepted bottles (comp.~\nameref{sec:depositRefundCycle} on \autopageref{sec:depositRefundCycle}). This design choice is easily explained: a deposit is to be charged by the distributor and each subsequent retailer (comp.~\nameref{sec:legalBasis} in \ref{sec:legalBasis}). Obviously, transferring the deposit to an escrow account afterwards would not lead to any noticeable benefits compared to direct a settlement. Still, such a change in course will represent the major enabler to an incentivized deposit-refund system as is depicted in \autoref{fig:depositCycleFuture}.

\begin{figure}[hbt]
	  \includegraphics[width=\textwidth]{images/concept/deposit_cycle_future_one_way_token}
	  \caption[Future deposit-refund cycle]{Future deposit-refund cycle \footnotemark}
	  \label{fig:depositCycleFuture}
\end{figure}

\footnotetext{An extended version detailing the three differently balanced accounting states (comp.~\ref{sec:depositRefundCycle}) can be found in the \autoref{app:concept} on \autopageref{fig:depositCycleFutureExtended}.}

\FloatBarrier

Leveraging Ethereum's decentralized application platform and built-in cryptocurrency (see~\ref{sec:ethereumOverview}), \ac{DPG} could provide participants of the deposit-refund cycle with a fully autonomous method for settling refund claims by deploying a smart-contract that will act as a central clearing house and simultaneously allow for the incentivized structure presented beforehand. A semantic change to the regulatory underpinnings will not be required, with the only difference being that upon first levying a deposit, this deposit must be converted into Ether and sent to the smart-contract (step 1a of \autoref{fig:depositCycleFuture}). At the same time, a non-fungible token (see~\ref{sec:fungibility}) representing the newly introduced bottle is created using the bottle's unique identifier and associated with the purchaser's identity (step 1b of \autoref{fig:depositCycleFuture}). Keeping in mind the actor's various obligations (see~\ref{sec:preconditions}), the remainder of the system will be implemented as following: 

\begin{itemize}
	\item [(2)] Like today, the deposit of a one-way bottle is still directly paid to the retailer upon each subsequent sale and as indicated above, not again transmitted to the smart-contract. However, should the consumer qualify for a penalty (see~\ref{sec:rules}), this penalty (converted to Ether) is sent to the smart-contract along with the purchase report itself. Furthermore, each report causes the token to be re-associated with the new consumer. In case that the previous owner had to pay a penalty \footnote{Even though unlikely, this indicates that a retailer has lost or thrown away one-way bottles.}, that amount will be credited to him for later withdrawal as he is not responsible for the bottle anymore.
	\item [(3a)] By returning a one-way bottle, the accompanying report triggers the smart-contract to compare the consumer's identity with that recorded for the bottle (i.e.~that associated with the token). Should these match, the penalty will be credited for later withdrawal. Otherwise, the penalty is withheld (comp.~\ref{sec:rules}). Irrespective of the outcome, the token is destroyed meaning that the bottle's identifier may be reused in the future. Additionally, tack-back points must physically refund the consumer (comp.~\ref{itm:levyDepositObligation} on \autopageref{itm:levyDepositObligation})
	\item [(3b)] Should the consumer decide to throw away a one-way bottle, this information is (likely) to be reported by garbage collection sooner or later and triggers an increase in the responsible consumer's record of thrown away bottles which is used to calculate his penalty (comp.~\autoref{eq:penaltyCalculcation}). Assuming that a penalty had been paid for this bottle, it is withheld (comp. \ref{sec:rules}). Lastly, the token is burned and the number of bottles which have been thrown away in the current period is incremented, as is required to correctly calculate \autoref{eq:rewardCalculation}.
	\item [(4)] Since tack-back points still directly refund consumers, settlement for these advance payments is needed. This happens by transmitting the same signed dataset which is used today and produced either by a reverse vending machine or a commissioned counting center (see~\ref{sec:depositRefundCycle}). The smart-smart contract can then verify the payload's signature, after which a message with equivalent value in Ether will be sent to the refund claimant's (i.e. the caller's) address. 
	\item [(5)] Environmental agencies can simply claim their donation by signing a transaction and addressing it to this smart-contract, though, for it to work, the encapsulated message must contain the appropriate function signature (see~\ref{sec:accounts}). Determining that a caller is indeed an environmental agency happens by looking up his approval status. Likewise, eligible consumers (i.e.~those that have been reported to have purchased reusable bottles) can claim their reward in the same fashion with the difference being that permission does not have to be checked since the reward amount is not statically calculated (comp.~\autoref{eq:rewardCalculation}) and by such would simply result in a zero value.
\end{itemize}

\subsection{Implications}


% Ethereum address as means of identification
% rewards and donations will be credited in Ether and are to be exchanged for fiat
% withdrawal pattern due to recommended Ethereum design guideleines
% penalties must always be withdrawed as the reverse vending machine would have to otherwise look up the penalty and convert it to fiat or this amount would have to be noted for each return to be submitted in a later claim both of which are impractical
% deposits must always be converted to Ether but can be directly refunded as the retailer either already received this amount during a purchase resulting in a perfectly balanced accounting state or will definitely be reimbursed for making an advance payment by proving the number of accepted bottles




%	- number of clicks (user interaction), latency normalized to 1 second, execution price, execution duration, availability, reliability, privacy, reputation, usability, maintainability

%- Usability (Rechenzeit, Storage, Dauer, Kosten)
%- Design Ansätze > Backlog, Wartezeit (Vergleich mit Internetspeed damals), Transaktionsminimierung
%- Public oder Private Blockchain?
%- Abrechnung pro Monat, da ansonsten kein Prozentsatz ermittelt werden kann
%- nicht-funktional > schnelle Antwortzeiten, günstige Transaktionen, Skalierbarkeit 

%- A/B schema > storage restriction
%- accounting relevancy > via modifiers
%- access control > via DPG 
%- floating point calculation
%- non-fungible token
% - modulirization
 

\subsection{Blockchain Value Add}

\subsection{Conversion of Deposits}
\begin{description}
	\item[Public]
	\hfill \\
	
	\item[Private]
	\hfill \\
	
\end{description}

%\subsection{Modularisation}
